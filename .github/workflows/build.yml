name: Opencart module build
on:
  push:
    branches:
      - '*'
    tags-ignore:
      - '*'

env:
  OC_DB_HOSTNAME: localhost
  OC_DB_USERNAME: root
  OC_DB_PASSWORD: root
  OC_DB_DATABASE: tests_opencart
  OC_DB_DRIVER: mysqli
  OC_USERNAME: admin
  OC_PASSWORD: admin
  OC_EMAIL: test@test.com
  SERVER_PORT: 80
  SERVER_URL: http://localhost

jobs:
  tests:
    name: Tests
    runs-on: ubuntu-latest
    steps:
      - name: Set up php
        uses: shivammathur/setup-php@v2
        with:
          php-version: '7.0'
        env:
          TEST_SUITE: 2.3
          OPENCART: 2.3.0.0
      - name: Chekout
        uses: actions/checkout@v2
      - name: Tests
        run: make before_script && composer test
